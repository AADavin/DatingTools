import ete3

map_code_species = dict()
map_code_taxa = dict()
map_code_name = dict()

with open("/Users/adriandavin/Desktop/CyanobacteriaBudapest/good_taxonomy.tsv") as f:
    for line in f:
        h = line.strip().split("\t")
        code = h[0]
        species = h[-1].split(",")[1].strip()

        map_code_taxa[code] = h[-1]

        if species == "Cyanobacteria":
            map_code_species[code] = "CYANO"
        elif species == "Candidatus Melainabacteria":
            map_code_species[code] = "MELAINA"
        else:
            map_code_species[code] = "PLANT"

        print(code, h[2])
        map_code_name[code] = h[2]


map_code_species[""] = "PLANT"
map_code_species["CAPCH"] = "PLANT"
map_code_species["PHODC"] = "PLANT"
map_code_species["CAPBA"] = "PLANT"
map_code_species["OSPN"] = "CYANO"
map_code_species["MISSING"] = "PLANT"


mytree = ete3.Tree("(MONEN:0.3300217407,((CHLRE:0.1068095592,VOCAN:0.1177684783)100:0.0373531239,GONPE:0.1364791052)100:0.1199896879,((((((((((((((((((((((PRSPN:0.0739928011,(PRSPN5018:0.0063074932,PROM3:0.0070470630)100:0.0016942471)99:0.0021638163,PRSPN1780:0.0094668449)57:0.0021148347,((((PRMAN0623:0.0124650786,PRMAN0851:0.0069236315)100:0.0021142490,PRMAN3782:0.0066465634)100:0.0045323695,(PROMM:0.0069020042,PRMAN8307:0.0071316229)100:0.0010122020)100:0.0030898076,PRMAN3754:0.0082167117)100:0.0043453925)100:0.0111940477,PRSPN1068:0.0159859983)100:0.1015378410,(((((PROMT:0.0095620541,PROM1:0.0082390172)100:0.0026207909,PRMAN6703:0.0116204675)100:0.0187297782,PRSPN7246:0.0237540477)100:0.1983356557,((((((PRMAN3857:0.0405962922,(((((PRMAN1364:0.0204738922,PRSPN5841:0.0182560702)96:0.0047122535,PRMAN7863:0.0248802013)96:0.0025005762,PROMS:0.0221448945)100:0.0063567847,(PROM0:0.0262979361,PRSPN3561:0.0294399908)98:0.0040785437)100:0.0038070616,((PROM2:0.0083402939,PRMAN3764:0.0092759869)100:0.0256360229,PRMAN8052:0.0408829545)87:0.0105917271)87:0.0032112039)87:0.0056750417,PRMAN8425:0.0370882319)87:0.0100794859,PRMAN2687:0.0351070426)87:0.0060852257,PROM9:0.0350266563)100:0.0215766160,PRMAN3865:0.0535949338)100:0.0664297817,(PROM5:0.0646096408,PROMP:0.0523630069)100:0.0566740362)100:0.3394948863)100:0.0831506437,((PRSPN8635:0.1685946409,PROM4:0.1484814690)100:0.0668684202,(PRSPN1278:0.1653926826,PROMA:0.1497043829)100:0.0933120608)100:0.0506556981)100:0.1591082317)100:0.0599803134,((((CYBAN0743:0.0827664373,(SYNPX:0.0041865339,SYNPZ:0.0048556254)100:0.0598055317)100:0.0302006874,((CYBAN7658:0.0833253317,((SYNSC:0.0201509430,SYSPN8265:0.0246828134)100:0.0121026159,SYSPN6350:0.0298125677)100:0.0504893395)100:0.0279152046,(SYNS9:0.0216619512,SYSPN3758:0.0202324866)100:0.1045079996)100:0.0224026497)100:0.0226978045,(((SYSPN6048:0.0609590613,SYSPN4537:0.0453659210)100:0.0573639690,CYBAN:0.0900065627)100:0.0224664836,(SYSPN4253:0.0028289746,SYSPN1835:0.0030394686)100:0.0879175307)100:0.0222601011)100:0.0572824369,(((((SYNS3:0.0198786066,SYNPY:0.0275805764)100:0.0121935469,SYSPN4107:0.0288498630)100:0.0106341788,SYSPN0865:0.0283526932)100:0.1083826181,(((SYNPW:0.0377035799,SYSPN8012:0.0255855132)100:0.0117099103,SYNPV:0.0384118673)100:0.0649587536,(SYSPN2564:0.0278916210,SYSPN7546:0.0329093184)100:0.0756364264)100:0.0393539636)100:0.0333687871,((SYSPN7640:0.0687456473,SYSPN6243:0.0839382573)100:0.0533094024,SYSPN5608:0.1048150306)100:0.0235787061)100:0.0344482466)100:0.0314774729)100:0.0873392123,(((SYSPN5461:0.1299750403,SYSPN3625:0.1189848216)100:0.0470875093,SYSPN3427:0.1350597837)100:0.0224395377,((CYAGP:0.0630088196,CYSPN0267:0.0733924269)100:0.0905141726,(SYSPN4713:0.1177704502,(CYBAN1648:0.1169954315,(CYSPN:0.0461821466,CYSPN1850:0.0415542806)100:0.0799024452)100:0.0318683532)100:0.0323393788)100:0.0309406315)100:0.0432573536)100:0.0441692796,(((SYSPN8164:0.0452709963,SYSPN7613:0.0544498765)100:0.0657848094,(SYSPN8423:0.0461827709,SYNR3:0.0364812860)100:0.0799102534)100:0.0473756187,(SYSPN8503:0.0083615908,SYSPN8270:0.0155383797)100:0.1587590018)100:0.0734378936)100:0.0880369225,(((CASYN0673:0.0707413990,CASYN:0.0557070434)99:0.0185293642,CASYN5410:0.0462541291)98:0.0131043732,CASYN7685:0.0541369612)100:0.2754929377)100:0.2457330956,(SYNP6:0.0022439397,SYNE7:0.0011624573)100:0.1891282037)100:0.0701760364,PRHON:0.2283228211)100:0.0451146589,(LISPN:0.0073701187,LISPN5820:0.0095985487)100:0.2571630651)90:0.0337467551,(((((((((LEVAN:0.4205210466,(PHSPN:0.0246096139,PHWIN:0.0623095922)100:0.1365528182)100:0.1133869669,(OSACN:0.1712777780,PLSPN0742:0.1676271369)100:0.0418160881)85:0.0340516501,((((((PLTEN:0.0438013478,PLSEN:0.0357537897)98:0.0165499896,((PLPAN:0.0150236267,OSCYN6120:0.0238782328)100:0.0083550990,((PLAGN:0.0088738032,PLARU:0.0100268867)100:0.0166465910,PLSPN4208:0.0183806858)100:0.0062960773)100:0.0406585984)100:0.1114440507,(((ARMAN:0.0027609798,ARPLN2750:0.0010230092)100:0.0015552848,ARSPN5301:0.0009373001)100:0.0178991439,ARTPN:0.0189933347)100:0.1601871075)95:0.0240332200,(LIRON:0.0514274520,(LYNSP:0.0192733027,LYAEN:0.0200235428)100:0.0430020227)100:0.0918634042)100:0.0495266003,(TRIEI:0.0711447192,HYSPN:0.0430363982)100:0.1468998853)100:0.0289941979,(((MIVAN:0.0164013186,OSNIN:0.0153972686)100:0.0351876055,TYBON:0.0564533755)100:0.0841560945,(OSPN:0.0533828454,OSCYN0524:0.0821069164)100:0.0650920622)100:0.0619345443)100:0.0371655041)85:0.0234695994,((((((HABYN:0.2598977722,TOSPN6257:0.0310769092)70:0.0738215403,((((((NOLIN4125:0.1120949705,NOLIN:0.0154465176)100:0.0146072524,NOCAN:0.0238385219)100:0.0254109446,(((NOSPN6034:0.0094616589,NOSPN4870:0.0067233849)100:0.0153974436,NOSPN7016:0.0198300710)100:0.0073009647,((NOSPN3041:0.0129724746,NOSPN8317:0.0087498797)100:0.0132059317,NOSP7:0.0178313965)100:0.0098362832)100:0.0266292935)100:0.0359533848,((((((RACUN:0.0129878581,(CYRAN1728:0.0044805621,CYSPN7185:0.0037155738)100:0.0094471526)100:0.0067672164,((RABRN:0.0051330570,CYRAN5748:0.0022512941)100:0.0094386113,CYRAN8072:0.0104361655)100:0.0118174245)100:0.1548942023,NOSA0:0.0576516321)95:0.0188593726,ANACC:0.0507607286)95:0.0171403371,((((ANSPN7810:0.0108453837,(ANSPN6713:0.0054208116,(ANSPN2605:0.0033797969,ANSPN5076:0.0030783633)100:0.0038749800)100:0.0018310124)100:0.0212882830,(DOCON:0.0228267225,(APFLN:0.0070983267,ANSPN1730:0.0081575773)100:0.0075418721)100:0.0173395936)100:0.0143097566,((APFLN0413:0.0031783934,ANSPN5310:0.0016948266)100:0.0023458635,APFLN8506:0.0034903675)100:0.0335344590)100:0.0144541008,ANSPN:0.0489089173)100:0.0647333701)100:0.0440869683,CYSTN:0.0635548706)98:0.0240958632)98:0.0116649882,(CASPN6245:0.0672866917,(((CABRN:0.0416042684,CASPN1826:0.0284182190)100:0.0161781452,((NOSPN0361:0.0153905259,(NOSPN8123:0.0029526790,NOSPN4760:0.0021072619)100:0.0111745123)100:0.0137078140,CASPN7681:0.0374191939)100:0.0093264655)100:0.0113655632,(TOSPN:0.0076168072,(NOCAN5108:0.0088202805,TOTEN:0.0064141326)98:0.0031212917)99:0.0431572304)99:0.0292538329)99:0.0174507531)95:0.0081282299,((NOSPN1640:0.0585527653,(((NOSPN:0.0076919367,NOSPN1523:0.0099331232)100:0.0238349629,NOSPN6713:0.0300991989)100:0.0251511357,CHOVN:0.0795606137)100:0.0499167052)100:0.0138785882,((NOSPN8346:0.0393400930,(NOPIN:0.0104614940,NOSPN1586:0.0139589105)100:0.0200521750)100:0.0534368332,(NOSS7:0.0581199970,((NOSPN6734:0.0026031050,NOSPN4071:0.0032261850)100:0.0382860589,(NOSS1:0.0113200014,ANAVT:0.0201463971)100:0.0278732890)100:0.0305392786)100:0.0243457057)100:0.0154421755)99:0.0097763426)96:0.0265231422)62:0.0187330361,(((((((RIINN0678:0.0070137468,RIINN4165:0.0142221723)100:0.1293321094,RIINN:0.0634507157)100:0.0988437890,(MATEN:0.1421318074,(RISPN:0.0433676633,CAPAN4025:0.0490032374)100:0.1077167606)100:0.0298809920)99:0.0210817563,(((((CAELN:0.0663476612,CASPN:0.0516193615)100:0.0420752476,CASPN4217:0.1005301939)100:0.0287967774,CASPN8254:0.1508988051)96:0.0204149954,CASPN2780:0.1308987898)97:0.0345358729,CASPN8140:0.1214490324)79:0.0213134159)77:0.0167132932,((FISPN1562:0.0224383447,(MALAN:0.0613560547,HASPN:0.0154913978)90:0.0091418210)100:0.0253673585,((FISPN:0.0078329598,FIMAN:0.0015389679)88:0.0045183955,FISPN2467:0.0013414662)100:0.0282271907)100:0.0679897086)74:0.0142592753,((NOCYN:0.0512780513,(SCTON:0.0754956315,((TOCAN:0.0429669465,SCMIN:0.0325812575)50:0.0110038475,(SCSPN6274:0.0137357571,SCSPN:0.0182840049)100:0.0086273279)100:0.0288723265)99:0.0109228649)99:0.0298659936,(TOBON:0.0304042658,SCHON:0.0346467586)100:0.0784926981)99:0.0298084098)69:0.0061069115,CYBAN5082:0.9172252766)60:0.0091998884)100:0.0710409352,((ALATN:0.1437575298,CHTHN:0.1346358300)95:0.0247731364,(GLSPN5103:0.0120140211,CHSIN:0.0170506204)100:0.1158851301)100:0.0286835306)100:0.0450448559,(PHAMN:0.1752898910,(CHAP6:0.2678378200,CREPN:0.1302642551)100:0.0409489644)97:0.0221585887)99:0.0233299751,((((DASAN:0.0924244274,HALP7:0.0820368434)100:0.1526877135,RULAN:0.2474884255)100:0.0621514508,(((((((GESPN:0.0794633768,GESPN6317:0.0850315813)100:0.0498437283,(CYAAP:0.0026777556,CYAPN:0.0029448653)100:0.1118861263)100:0.0585823499,(CYASC:0.0484394333,CYSPN2376:0.0559478068)100:0.1087650556)100:0.1380586738,(((LESPN5706:0.0571820320,LIRON3845:0.0539583838)100:0.0734678735,(SYSPN4826:0.0639712180,((SYNP2:0.0060742383,SYSPN2134:0.0065673924)100:0.0128127211,SYSPN1267:0.0173806940)100:0.0375657695)100:0.0560619347)100:0.1572001497,(SYNY3:0.0346529028,SYNY4:0.0385961397)100:0.2219103445)94:0.0401475279)92:0.0306567720,GLSPN:0.2341291857)91:0.0288360907,(((PLSPN:0.0221857481,HYRIN:0.0103796371)100:0.1217679051,((((((((((MICAN:0.0042945978,MIAEN:0.0027900764)100:0.0031670549,MIAEN7846:0.0064537501)100:0.0022274368,MIAEN6184:0.0064552511)100:0.0033329344,MIAEN0287:0.0070054498)100:0.0033892900,((((((MIAEN4850:0.0039186704,MIAEN3216:0.0035084995)85:0.0010099064,(MIAEN5703:0.0029034927,MIAEN7120:0.0025549416)100:0.0021043090)82:0.0006419694,MIAEN4610:0.0035548606)100:0.0015149737,MIAEN7154:0.0042284274)100:0.0030642424,(MIAEN1647:0.0001027308,MIAEN6735:0.0003036648)100:0.0071263285)100:0.0061309870,((MIAEN2536:0.0053224381,MIAEN6478:0.0050926239)100:0.0042731846,MIPAN:0.0081366513)100:0.0029442554)86:0.0024294464)86:0.0020626196,MIAEN4173:0.0101836303)84:0.0021157409,MIAEN4873:0.0115723265)46:0.0020439546,(MIAEN8530:0.0074372766,MIAEN6713:0.0094647936)100:0.0041717616)59:0.0036815875,MISPN4532:0.0078909983)100:0.2000144958,(CYAP7:0.0730664240,CYAP2:0.0810373097)100:0.0721668777)100:0.0307633876)94:0.0202462805,(((ATETH:0.0721077221,CAATN:0.0657023433)100:0.1838629442,(((CRWAN1546:0.0003844819,(CRWAN5728:0.0027950572,CRWAN6275:0.0032828636)98:0.0002596609)100:0.0013250977,((CRWAN:0.0033909104,CRWAN1063:0.0032533538)100:0.0004212808,CRWAN8763:0.0032090418)100:0.0007885164)100:0.0632217043,(CYAA5:0.0376666804,CYSPN2086:0.0357040086)100:0.0309278311)100:0.0483759371)100:0.0694202010,(CYENN:0.1594151545,CYAP8:0.1034095039)100:0.0370405475)100:0.0665636232)97:0.0342047792)82:0.0191963150,((CHSPN:0.1724402116,XESPN:0.1621985587)100:0.0410078043,STAC7:0.1268532688)100:0.0756396699)100:0.0519431345)100:0.0506636909,((COCHN:0.1362081870,MISPN:0.1083861284)99:0.0248473865,((MOPRN:0.0164883775,MOPRN1862:0.0108841255)100:0.0047213981,(MOPRN3256:0.0108633244,MOBON:0.0122006766)100:0.0053191235)100:0.1451231603)100:0.0497960661)100:0.0279359640)100:0.0179237376)83:0.0216676913,(ROREN:0.2193194224,DESPN:0.1444154744)100:0.0636050881)87:0.0318831248,(((((LESPN8574:0.0342617474,LESPN8031:0.0344284315)100:0.0450922357,LEBON:0.0584753393)100:0.1114391716,ALSPN:0.1857829695)100:0.0612510792,OSCYN:0.1616931689)100:0.0395729593,(LESPN:0.1544248769,NESPN:0.1798814982)96:0.0348099091)80:0.0240661262)58:0.0193282951,GESPN0235:0.1922874323)74:0.0217757655,((((APMON:0.0828129800,LYCON:0.0151319365)100:0.1740667874,(PHTEN:0.1752575138,HAHON:0.1725791012)97:0.0320424547)100:0.0361094723,((SYNS7:0.1205959312,PHPRN:0.1138279487)100:0.1250193391,(LESPN3182:0.0687571286,LESPN3520:0.0895823345)100:0.1357328968)100:0.0809821366)100:0.0616380649,LESPN2547:0.1844484122)99:0.0360049963)86:0.0277408551,(ACAM1:0.2371401252,(((THEEB:0.0204549226,THSPN:0.0188569614)100:0.1996455637,SYNP3:0.1936664843)100:0.0844974913,CYAP4:0.1609756059)100:0.0454726287)100:0.0582319517)69:0.0291116954)99:0.0476740740,((((PSBIN:0.0534136360,PSSPN4106:0.0381744059)100:0.0320105289,OSCYN5418:0.0661359810)100:0.1501587153,SYSPN:0.2073743608)100:0.0509419536,PSSPN:0.2012256624)100:0.1443554230)83:0.0432482587,GLLIN:0.3663390676)100:0.0604074745,(SYNJB:0.0557266610,SYNJA:0.0576665960)100:0.2596994102)100:0.0641460562,(GLOVI:0.1213043731,GLKIN:0.1217482774)100:0.2452826035)100:0.1608974784,(((((CAMEN2138:0.4099843460,((((CAMEN7851:0.0037503886,CAGAN8762:0.0028083915)100:0.0838945497,(MESPN:0.0069821499,CAGAN0348:0.0073748166)100:0.0774831976)100:0.0807855017,(CAGAN0261:0.0669464505,CAGAN5463:0.0606683869)100:0.1139602650)100:0.0617135689,((CAGAN2805:0.0190951553,((CAGAN4735:0.0319946231,(CAGAN7630:0.0007710505,CAGAN5783:0.0008905213)100:0.0057165716)89:0.0014372715,((CAGAN6430:0.0024630052,(CAGAN4703:0.0030007533,CAGAN5263:0.0044066240)100:0.0024359469)100:0.0030175492,CAGAN6541:0.0078138656)99:0.0061139512)90:0.0053935626)100:0.1734774465,CAGAN:0.1915949901)100:0.0500072402)100:0.0922061931)95:0.0380109707,CAGAN5184:0.2489703762)100:0.1320281989,((CAMEN4156:0.1779579555,CAMEN:0.2402847374)100:0.0574168225,((CAMEN8072:0.0038664955,CAMEN6580:0.0023133069)100:0.0417821652,CAMEN5637:0.0201031712)100:0.1660997570)100:0.1236515229)100:0.1945942941,(CAMEN5280:0.1751778696,CAMEN1605:0.1506021063)100:0.3652047637)100:0.1482589090,CYBAN2184:0.5917397900)100:0.1072928943)100:0.1632829346,((((CHOCR:0.3694626213,PORPP:0.4461955227)99:0.0482774559,GALSU:0.4934250445)98:0.0516612450,CYAM1:0.4658385549)100:0.1036229243,CYAPA:0.3737593032)98:0.0439669759)100:0.1929910170,(((SELML:0.2999848855,(PHYPA:0.2071917847,MAPON:0.2389799913)100:0.0486487927)100:0.0613666171,(((((((((GEAUN:0.1546323554,ERYGU:0.1139321634)100:0.0318552091,MISSING:0.3279509516)100:0.0320898371,(((SOLLC:0.0407802336,SOLTU:0.0231912026)100:0.0259045725,((CAPBA:0.0492806261,CAPCH:0.0088938671)100:0.0033570901,CAPAN:0.0086074487)100:0.0560408803)100:0.0234873814,((TOBAC:0.0133011482,NICSY:0.0182947978)100:0.0087189706,NICAT:0.0283923775)100:0.0299837038)100:0.1083655045)100:0.0233414518,(DACAN:0.1226030354,HELAN:0.1657189734)100:0.0313263576)99:0.0235329689,SPIOL:0.2556678064)99:0.0207540902,(VITVI:0.1630566109,((((((((BROLN:0.0362646611,BRANA:0.0247670013)100:0.0282589517,BRARP:0.0317984196)100:0.0402596835,EUTSA:0.0605684376)100:0.0319187648,ARAAL:0.0388685374)99:0.0163476078,(CARUN:0.0316086170,(ARALL:0.0153462855,ARATH:0.0201903460)100:0.0106794176)100:0.0155718384)100:0.1486020783,(PRUPE:0.1141304786,MONON:0.1453458130)98:0.0170797795)59:0.0185687302,(((CEPFO:0.1119406777,(CITSI:0.0232970274,CICLN:0.0184219403)100:0.1134050122)96:0.0144515448,(((GOSHI:0.0111435662,GOSAR:0.0254719153)100:0.0252478586,GOSRA:0.0323709791)100:0.0786399395,(THECC:0.0645917433,(COOLN:0.0183901518,COCAP:0.0234117721)100:0.0527374280)99:0.0098509267)100:0.0794974435)98:0.0141538216,(POPTR:0.1114889108,(JATCU:0.0704020038,RICCO:0.0845492084)100:0.0382230840)100:0.0399165113)98:0.0191181247)60:0.0154790515,(((CUCSA:0.0325573519,CUCME:0.0123782160)100:0.1084044860,(EUCGR:0.0983134249,PUNGR:0.1195263852)100:0.0511421858)97:0.0237038528,(((MEDTR:0.0584140482,CICAR:0.0443714016)100:0.0535158353,(CAJCA:0.1254484480,((PHAVU:0.0223036628,(PHAAN:0.0090040843,VIGRR:0.0131626431)100:0.0187022221)100:0.0241408485,(GLYSO:0.0167050512,SOYBN:0.0200574566)100:0.0299705987)100:0.0091894345)100:0.0342624596)100:0.0216793967,LUPAN:0.0938510532)100:0.0642196077)58:0.0132728433)99:0.0220507654)88:0.0154797030)100:0.0322406950,(NELNU:0.1344606042,MACON:0.1285051289)100:0.0249678399)100:0.0510828129,(((((((((((ORYSJ:0.0055169288,(ORYSI:0.0187754711,(ORYRU:0.0128212734,ORYNI:0.0043377017)100:0.0006954710)100:0.0029729966)97:0.0014010617,ORGLN:0.0163508497)71:0.0017960258,(ORBAN:0.0252130850,ORYGL:0.0011121834)97:0.0037645376)72:0.0037856001,ORMEN:0.0124902346)73:0.0065526127,ORYPU:0.0275361777)100:0.0140117779,(LEPEN:0.0317315785,ORYBR:0.0434509085)100:0.0084802499)100:0.0306306228,(((MAIZE:0.0279645864,SORBI:0.0350824628)100:0.0182482618,(DIOLN:0.0458556713,SETIT:0.0281079636)100:0.0109328628)100:0.0314911835,((HORVV:0.0868463708,(WHEAT:0.0089806383,TRIUA:0.1181419801)100:0.0043041124)100:0.0265546024,BRADI:0.0340081499)100:0.0291243510)100:0.0146596951)100:0.1422702547,ANACO:0.0887278068)100:0.0272198055,MUSAM:0.1406306621)99:0.0189332199,PHODC:0.1063378630)100:0.0502766166,ZOSMR:0.2187486993)100:0.0344905138)100:0.0518551384,AMBTC:0.1861827824)100:0.1803585662)100:0.0816276428,KLENI:0.3216014068)100:0.0844391694)100:0.0824615486,(((OSTTA:0.1307764213,OSTLU:0.1067724619)100:0.1984381902,BAPRN:0.3293467641)100:0.0758652020,(MICCC:0.1684390705,MICPC:0.1780259983)100:0.1192149287)100:0.1941253660)100:0.1046588549,(COCSC:0.2675220711,(CHLVA:0.2111968868,(AUXPR:0.2655152968,HESPN:0.4422086291)98:0.1003534516)100:0.0639217151)100:0.0512698434)100:0.1193715004);",format=0)

for l in mytree.get_leaves():
    try:
        print(l.name)
        print(map_code_name[l.name])
        l.name = l.name + "_" + map_code_name[l.name]
        print(l.name)
    except:
        pass

print(mytree.write(format=1))

